<!--coupon.wxml-->
<view class="page">
  <!-- 优惠券标签栏 -->
  <view class="tab-bar">
    <view class="tab-item {{currentTab === 0 ? 'active' : ''}}" bindtap="switchTab" data-tab="0">
      未使用
    </view>
    <view class="tab-item {{currentTab === 1 ? 'active' : ''}}" bindtap="switchTab" data-tab="1">
      已使用
    </view>
    <view class="tab-item {{currentTab === 2 ? 'active' : ''}}" bindtap="switchTab" data-tab="2">
      已过期
    </view>
  </view>

  <!-- 优惠券列表 -->
  <view class="coupon-list">
    <block wx:for="{{coupons}}" wx:key="id">
      <view class="coupon-item {{item.status === 1 ? 'used' : (item.status === 2 ? 'expired' : '')}}">
        <view class="coupon-left">
          <view class="coupon-amount">
            <text class="rmb">¥</text>
            <text class="amount">{{item.amount}}</text>
          </view>
          <view class="coupon-desc">{{item.desc}}</view>
        </view>
        <view class="coupon-right">
          <view class="coupon-condition">满{{item.condition}}元使用</view>
          <view class="coupon-expire">有效期至{{item.expireDate}}</view>
          <button class="coupon-btn {{item.status !== 0 ? 'disabled' : ''}}"
                  bindtap="useCoupon"
                  data-coupon="{{item}}"
                  disabled="{{item.status !== 0}}">
            {{item.status === 0 ? (item.isReceived ? '立即使用' : '立即领取') :
              (item.status === 1 ? '已使用' : '已过期')}}
          </button>
        </view>
      </view>
    </block>
  </view>

  <!-- 空状态 -->
  <view class="empty-state" hidden="{{coupons.length > 0}}">
    <image class="empty-icon" src="../../images/empty_coupon.png"></image>
    <text class="empty-text">暂无优惠券</text>
    <button class="empty-btn" bindtap="goToGetCoupon">去领取</button>
  </view>
</view>